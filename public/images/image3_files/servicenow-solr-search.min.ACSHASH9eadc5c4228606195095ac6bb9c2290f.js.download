var jsonEntries,resultsJsonObj,originalData={},filterListSelected=[],filterListSelectedDigitalData=[];let solrCountPaging=15;var pfromId=1,isRelevance=!0;const solrNoDesc="No Description";var jsonObjList,actualIndex=0,pageNumber=1,totalResults=0;let correctedSearchTerm,sortBySelectedValue="sort_by",sortBySelectedValueText=Granite.I18n.get("solrFilterBy"),solrTitle=Granite.I18n.get("solrTitle"),initialFacets=[],buttonFilterClicked=!1;function focusOnSolrSearchInput(){$(".search-panel-solr form input").focus()}function displayErrorSolr(e,s,t){errorHTML='<div class="background-component fluid-width light-grey-bg">\n',errorHTML+="\t<div>\n",errorHTML+='\t\t<div id="8e83288c-81dc-4404-84fd-e1f991053435" data-component-name="textJumboRefresh">',errorHTML+='\t\t\t<div class="text-col">',errorHTML+='\t\t\t\t<div class="new-text-jumbo  text-center">',errorHTML+='\t\t\t\t\t<div class="component text-component subtitle-block gotham-juliett font-color-grey-1">',void 0!==t?(errorHTML+="\t\t\t\t\t\t<h3>"+e+" '"+searchTerm+"'</h3>",errorHTML+="<p>"+totalResults+" "+Granite.I18n.get("solrResultNumber")+"</p>",errorHTML+="\t\t\t\t\t\t</div>",errorHTML+='\t\t\t\t\t<div class="component text-component text-block  font-color-black">',errorHTML+="\t\t\t\t<p>"+s+" '"+searchTerm+"' "+t+"</p>"):(errorHTML+="\t\t\t\t\t\t<h3>"+e+"</h3>",errorHTML+="\t\t\t\t\t\t</div>",errorHTML+='\t\t\t\t\t<div class="component text-component text-block  font-color-black">',errorHTML+='\t\t\t\t<p class="error-message">'+s+"</p>"),errorHTML+="\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n</div>\n</div>",$(".search-solr-results").html(errorHTML)}function displaySearchSolrResults(e){setGlobalJsonObj(e),jsonObjList=e.hits,1==e.success&&parseInt(e.results)>0?($(".search-solr-results").html(getHTMLFromJsonSolr()),initShowHideFilter()):e.didyoumean&&e.didyoumean.localeCompare("null")?(searchTerm=e.didyoumean,correctedSearchTerm=searchTerm,solrTitle=Granite.I18n.get("solrShowingResultsTitle"),solrSearchAjaxCall(reloadView,!0,!0)):0==e.success?displayErrorSolr(Granite.I18n.get("solrSearchErrorTitle"),Granite.I18n.get("solrSearchErrorMessage")):displayErrorSolr(Granite.I18n.get("solrNoResultsTitle"),Granite.I18n.get("solrNoResultsMessageFirst"),Granite.I18n.get("solrNoResultsMessageSecond"))}function trimDescription(e){const s="<strong>".length,t="</strong>".length;let l=0,r="";const a=e.trim(),o=a.replace(/\<strong\>|\<\/strong\>/g,"");let i=a;for(;l<200&&i.length>0;){let e=i.indexOf("</strong>");if(e>-1&&e-s<=200-l)l+=e-s,r+=i.substring(0,e+t),i=i.substring(e+t);else{let e=200-l;r+=i.replace(/\<strong\>|\<\/strong\>/g,"").substring(0,e),l=200}}if(200==l&&l<o.length){for(;"."===r[r.length-1]||" "===r[r.length-1];)r=r.slice(0,-1);r+="..."}return r}function getSearchHTMLSolr(e,s,t,l){"No Description"==t?t=Granite.I18n.get(solrNoDesc):Array.isArray(t)?t=trimDescription(t[0]):"string"==typeof t&&(t=trimDescription(t)),!window.location.pathname.includes("/uk/")||e.includes("/uk/")||e.includes(".co.uk/blogs")||(e="/uk"+e);var r='<li><a href="'+e+'" onclick="solrSearchResultsClickAnalytics('+("'Search Result Click','"+s+"','"+e+"','"+(l+1)+"',''")+')" target="_blank"><div><div>';return r+='<h5><div class="solr-results-item-title"><div class="title">'+s+"</div>",r+='<div class="underline"></div>',r+="</div></h5>",r+='<p class="medium-body-copy">'+t+"</p>",r+="</div></div></a></li>"}function setGlobalJsonObj(e){resultsJsonObj=e}function getHighlightedDescription(e,s){for(var t=0;t<s.length;t++){if(e==s[t].id)return s[t].description}return"No Description"}function getHTMLFromJsonSolr(){jsonObjList=resultsJsonObj.hits,hlObjList=resultsJsonObj.highlighting;var e=resultsJsonObj.results,s='<div class="search-solr-results-title">';s+="<h3>"+solrTitle+" '"+decodeURIComponent(searchTerm)+"'</h3>",s+="<p>"+e+" "+Granite.I18n.get("solrResultNumber")+"</p>",s+=' <div class="filter-btn-container">',s+=' <div class="filter-header-section">',s+=' <span class="thumbnail">',s+=' <img src="https://www.servicenow.com/content/dam/servicenow-assets/public/en-us/images/demonow-videos/filter.png">',s+="</span>",s+=' <div class="filter-section-right">',s+=' <span class="small-body-copy section-title">'+Granite.I18n.get("solrFilter")+"</span>",s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+='<div class="search-solr-results-header">',s+='<div class="search-summary">',s+="<h1>&nbsp;</h1>",s+="<h3>&nbsp;</h3>",s+="</div>",s+='<div class="sort-by-container">',s+='<div class="dropdown-container">',s+='<div class="header-section">',s+='<div class="section-right">',s+='<span class="small-body-copy section-title" data-value-selected="'+sortBySelectedValue+'">'+sortBySelectedValueText+"</span>",s+="</div>",s+="</div>",s+='<div class="dropdown-options">',s+='<ul class="option-container">',s+='<li data-value="'+Granite.I18n.get("solrSortRelevance")+'">'+Granite.I18n.get("solrSortRelevance")+"</li>",s+='<li data-value="'+Granite.I18n.get("solrSortDate")+'">'+Granite.I18n.get("solrSortDate")+"</li>",s+="</ul>",s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+="<ul class='solr-result-list'>";for(var t=0;t<jsonObjList.length&&t<10;t++)null!=hlObjList&&null!=hlObjList[t]&&""!==hlObjList[t].description?s+=getSearchHTMLSolr(jsonObjList[t].url,jsonObjList[t].title,getHighlightedDescription(jsonObjList[t].id,hlObjList),t):s+=getSearchHTMLSolr(jsonObjList[t].url,jsonObjList[t].title,jsonObjList[t].description,t),actualIndex++;return s+="</ul>"}function sortBySolrResults(){pfromId=1,solrSearchAjaxCall(reloadView,!1,!0)}function removeOldSearch(){if($(".searchSolrInput .component-dotcom-search-solr").length>0){const e=$("#drop-search .component-dotcom-search-solr"),s=$(e).attr("data-has-solr-search");e&&($("#drop-search").html($(".component-dotcom-search-solr")),$(e).css("display","on"==s?"block":"none"),"on"==s&&$("#search-mobile").on("click tap",function(){$(".component-dotcom-search-solr").css({"max-width":"100vw",display:"on"==s?"block":"none"}).addClass("active")}))}}function solrFilters(e){const s=$(".searchSolrResults .search-solr-container .left-search-solr-side"),t=$(".searchSolrResults .search-solr-container .right-search-solr-side"),l=$(".searchSolrResults .search-solr-container .left-search-solr-side .filter-top-section"),r=s.find(".all-filter-container"),a=r.find(".refine-section .new-filter-list"),o=r.find(".more-section"),i=t.hasClass("hasFilter");let n=null;if($(a).empty(),i&&e.hits.length>0&&e.facetTags.length>0){const r=e.facetTags;e.facetTags.length>4&&(o.append('<div class="filter-top-section"><div class="filter-title more-filter"><h4>'+Granite.I18n.get("solrMoreFilters")+'</h4></div></div><div class="new-filter-list"></div>'),n=o.find(".new-filter-list"),$(n).empty());for(var c=0;c<r.length;c++){const e=r[c].name,s=e.trim().toLowerCase(),t=r[c].tags;let l=!1;if(t.length>5)for(let e=5;e<t.length;e++)window.location.href.includes(t[e].id)&&(l=!0);if(c<=3?$(a).append('<div class="filter-list-inner-container"><div class="filter-item-container"><div class="filter-header-sec"><div class="title-container"><label class="container"><h5>'+e+'</h5><input type="checkbox" name="'+s+'"><span class="checkmark"></span></label></div><div class="title-arrow"><span><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22 7L12 17 2 7" stroke="#fff" stroke-width="2" fill="none" fill-rule="evenodd"></path></svg></span></div></div><div class="filter-collapse-sec"></div></div></div>'):n&&$(n).append('<div class="filter-list-inner-container"><div class="filter-item-container"><div class="filter-header-sec"><div class="title-container"><label class="container"><h5>'+e+'</h5><input type="checkbox" name="'+s+'"><span class="checkmark"></span></label></div><div class="title-arrow up"><span><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22 7L12 17 2 7" stroke="#fff" stroke-width="2" fill="none" fill-rule="evenodd"></path></svg></span></div></div><div class="filter-collapse-sec collapsed"></div></div></div>'),c<=3&&t.length>5&&($(a.find(".filter-collapse-sec")[c]).append(`<div class="load-more-sec" id=load-more-${c}>`+"<span>"+Granite.I18n.get("solrLoadMore")+'</span></div><div class="load-more-sec-childs"></div>'),!0===l)){const e=$(`#load-more-${c}`);e.siblings(".load-more-sec-childs").addClass("open"),e.css("display","none")}if(c>3&&t.length>5&&n&&($(n.find(".filter-collapse-sec")[c-4]).append(`<div class="load-more-sec" id=load-more-${c}>`+"<span>"+Granite.I18n.get("solrLoadMore")+'</span></div><div class="load-more-sec-childs"></div>'),!0===l)){const e=$(`#load-more-${c}`);e.siblings(".load-more-sec-childs").addClass("open"),e.css("display","none")}for(var d=0;d<t.length;d++){const e=t[d].name,s=t[d].id;let l="";c<=3?l=a.find(".filter-collapse-sec")[c]:n&&(l=n.find(".filter-collapse-sec")[c-4]),d>4?$(l).find(".load-more-sec-childs").prepend('<div class="filter-inner"><label class="container">'+e+'<input type="checkbox" name="'+s+'"><span class="checkmark"></span></label></div>'):$(l).prepend('<div class="filter-inner"><label class="container">'+e+'<input type="checkbox" name="'+s+'"><span class="checkmark"></span></label></div>')}}$(t).removeClass("solr-flex-box-col"),$(t).removeClass("solr-left-padding"),$(t).removeClass("solr-right-padding"),$(t).removeClass("flex-box-col-md-10"),$(t).addClass("offset-xl-1 flex-box-col-md-7 flex-box-col-lg-8 flex-box-col-xl-9"),$(s).css("display","inline-block"),$(l).css("display","flex"),filterEvents(),$(".left-search-solr-side").css("display","block"),$(".search-solr-container").addClass("filters-visible")}else $(s).css("display","inline-block"),$(s).css("display","none"),$(l).css("display","none"),$(".search-solr-container").removeClass("filters-visible")}function checkCategoryFilter(e){const s=e.parents(".filter-collapse-sec").prev().find("input"),t=e.parents(".filter-collapse-sec").find(".filter-inner input");let l=!0;t.map(function(e,s){$(s).prop("checked")||(l=!1)}),s.prop("checked",l)}function checkClearAll(){const e=$(".clear-all-container span");filterListSelected.length?e.css("display","inline"):e.css("display","none")}function filterEvents(){const e=$(".new-filter-list"),s=e.find(".filter-inner input"),t=e.find(".filter-header-sec input"),l=$(".clear-all-container span");s.click(function(){let e=$(this),s=e.prop("name"),t=e.prop("checked");var l={};if(l[$(e).parent().text()]=s,t)e.prop("checked",!0),filterListSelected.push(s),filterListSelectedDigitalData.push(l),solrFacetUpdateAnalytics("Search Facet Change",filterListSelectedDigitalData);else{e.prop("checked",!1),filterListSelected.splice(filterListSelected.indexOf(s),1);var r=indexOfData(filterListSelectedDigitalData,l);filterListSelectedDigitalData.splice(r,1)}checkCategoryFilter(e),checkClearAll(),pfromId=1,pageNumber=1,solrSearchAjaxCall(reloadView,!1,!0)}),t.on("click",function(){$(this);const e=$(this),s=e.parents(".filter-header-sec").next().find(".filter-inner input"),t=e.parents(".filter-header-sec").next().find(".load-more-sec"),l=e.parents(".filter-header-sec").next().find(".load-more-sec-childs");e.prop("checked")?(t.css("display","none"),l.addClass("open"),s.map(function(e,s){if(!$(s).prop("checked")){$(s).prop("checked",!0),filterListSelected.push($(s).prop("name"));var t={};t[$(s).parent().text()]=$(s).prop("name"),filterListSelectedDigitalData.push(t)}}),solrFacetUpdateAnalytics("Search Facet Change",filterListSelectedDigitalData)):(t.css("display","block"),l.removeClass("open"),s.map(function(e,s){$(s).prop("checked",!1),filterListSelected.splice(filterListSelected.indexOf($(s).prop("name")),1);var t={};t[$(s).parent().text()]=$(s).prop("name");var l=indexOfData(filterListSelectedDigitalData,t);filterListSelectedDigitalData.splice(l,1)})),checkClearAll(),pfromId=1,pageNumber=1,solrSearchAjaxCall(reloadView,!1,!0)}),$(".searchSolrResults .load-more-sec").click(function(){const e=$(this).siblings(".load-more-sec-childs");solrClickLabelAnalytics("Search Page Click","Search:Load more refinements"),e.hasClass("open")?e.removeClass("open"):(e.addClass("open"),$(this).css("display","none"))}),l.on("click",function(){t.prop("checked",!1),s.prop("checked",!1),t.parents(".filter-header-sec").next().find(".load-more-sec").css("display","block"),t.parents(".filter-header-sec").next().find(".load-more-sec-childs").removeClass("open"),filterListSelected=[],filterListSelectedDigitalData=[],checkClearAll(),pageNumber=1,solrSearchAjaxCall(reloadView,!1,!0)})}function solrSearchAjaxCall(e,s,t){var l="";$(filterListSelected).each(function(e){l=0==e?filterListSelected[0]:l+";"+this});let r="";sortBySelectedValue===Granite.I18n.get("solrSortDate")?(r="created_date",isRelevance=!1):sortBySelectedValue!==Granite.I18n.get("solrSortRelevance")&&"sort_by"!==sortBySelectedValue||(r="score",isRelevance=!0);let a='<div id="load-indicator"><img src="/etc.clientlibs/servicenow-www/clientlibs/servicenow-www-static/resources/icons/loader-white.gif" align="absmiddle"><div id="load-text">'+Granite.I18n.get("solrLoadingMessage")+"</div></div>";$(".search-solr-results #load-indicator").remove(),t?($(".search-solr-results").html(a),actualIndex=0,pageNumber=1):$(".search-solr-results .bottom-section").before(a);var o=getURLParameterByName("q",window.location.href);void 0!==correctedSearchTerm&&(o=correctedSearchTerm),initialFacets.length<1&&updateFacetsOnURL(l),$.ajax({url:resultsJsonurl,dataType:"json",data:{q:o,filterFacets:l,paginatedNumber:pageNumber,resultsPerPage:resultsPerPage,sortField:r,minResultsFilter:minResultsFilter,locale:currentpagelocalefrompath},success:function(t){"false"!=t.success&&t.success?(s||solrSearchResultsAnalytics("Search Results",o,t.results),e(t,s)):displayErrorSolr(Granite.I18n.get("solrEmptyStringTitle"),Granite.I18n.get("solrEmptyStringMessage"))},error:function(e){"timeout"==e.statusText?displayErrorSolr(Granite.I18n.get("solrSearchTimeoutTitle"),Granite.I18n.get("solrSearchTimeoutMessage")):displayErrorSolr(Granite.I18n.get("solrSearchErrorTitle"),Granite.I18n.get("solrSearchErrorMessage"))},timeout:searchTimeout})}function reloadView(e,s){originalData=Object.assign({},e),s?(solrFilters(e),updateFacetsFromURL()):(totalResults=e.results,displaySearchSolrResults(e,pageNumber),initSortBy(),continueLoadingResults())}function isMobileResolution(){var e=$(window).width(),s=$(window).height();return e<=1024&&s<=1024||!!(e<=1200&&s<=1200&&(navigator.userAgent.match(/Nexus/i)||navigator.userAgent.match(/Asus/i)))}function loadTenMore(e){if(jsonObjList){const l=actualIndex;for(var s=l;s<jsonObjList.length&&s<l+10;s++)null!=hlObjList&&null!=hlObjList[s]&&""!==hlObjList[s].description?$(".search-solr-results .solr-result-list").append(getSearchHTMLSolr(jsonObjList[s].url,jsonObjList[s].title,getHighlightedDescription(jsonObjList[s].id,hlObjList),s)):$(".search-solr-results .solr-result-list").append(getSearchHTMLSolr(jsonObjList[s].url,jsonObjList[s].title,jsonObjList[s].description,s)),actualIndex++;if(jsonObjList.length>0&&actualIndex<totalResults&&actualIndex%resultsPerPage==0&&!$(".search-solr-results .bottom-section").length){var t="<div class='bottom-section'>";t+="<h4 class='total-results'>1 - "+jsonObjList.length+" "+Granite.I18n.get("solrOf")+" "+totalResults+"</h4>",t+="<button class='solr-load-more' onclick='loadFiftyMore()'>"+Granite.I18n.get("solrLoadMore")+"</button>",t+="</div>",$(".search-solr-results").append(t)}else!e&&jsonObjList.length>0&&actualIndex<totalResults&&!$(".search-solr-results .bottom-section").length&&continueLoadingResults()}}function loadFiftyMore(){pageNumber++,solrClickLabelAnalytics("Search Page Click","Search:Load more results"),$(".search-solr-results .solr-load-more").attr("disabled",!0),solrSearchAjaxCall(function(e){jsonObjList=jsonObjList.concat(e.hits),hlObjList=hlObjList.concat(e.highlighting),$(".search-solr-results .bottom-section").remove(),$(".search-solr-results #load-indicator").remove(),loadTenMore(!1)})}function highlightSearchTerm(e,s){var t=e.indexOf(" ")>-1?e.split(" "):[e],l=s.split(" ");return l.forEach(function(e,s){for(var r=0;r<t.length;r++)e.toLowerCase().indexOf(t[r])>-1&&(l[s]="<b>"+e+"</b>")}),l.join(" ")}function initSortBy(){const e=$(".dropdown-container");e.on("click",function(s){e.toggleClass("open");const t=$(s.target).text(),l=$(s.target).attr("data-value");if(l&&"sort_by"!=l&&$(s.target).attr("data-value")!=sortBySelectedValue){const e=$(this).find(".header-section .section-title");e.text(t),e.attr("data-value-selected",l),(l===Granite.I18n.get("solrSortRelevance")&&sortBySelectedValue===Granite.I18n.get("solrSortDate")||l===Granite.I18n.get("solrSortDate")&&("sort_by"===sortBySelectedValue||sortBySelectedValue===Granite.I18n.get("solrSortRelevance")))&&(sortBySelectedValue=l,solrClickLabelAnalytics("Search Page Click","Search: Sort by "+l),sortBySolrResults()),sortBySelectedValueText=(sortBySelectedValue=l)===Granite.I18n.get("solrSortRelevance")?Granite.I18n.get("solrSortRelevance"):Granite.I18n.get("solrSortDate")}})}function initShowHideFilter(){$(".filter-header-section").length&&($(".filter-header-section").click(function(){$(".searchSolrResults .left-search-solr-side").addClass("open"),$(".searchSolrResults .dismiss-filter").addClass("open"),buttonFilterClicked=!0,$("body").css("overflow-y","hidden")}),$(".aplly-filter-submit-button").click(function(){$(".searchSolrResults .left-search-solr-side").removeClass("open"),$(".searchSolrResults .dismiss-filter").removeClass("open"),$("body").css("overflow-y","auto")}),$(".searchSolrResults .dismiss-filter").click(function(){$(".searchSolrResults .left-search-solr-side").removeClass("open"),$(".searchSolrResults .dismiss-filter").removeClass("open"),$("body").css("overflow-y","auto")}),$(".filter-header-sec .title-arrow").off("click").on("click",function(){const e=$(this).parents(".filter-item-container"),s=$(e).find(".filter-collapse-sec"),t=e.find(".title-arrow");s.hasClass("collapsed")?(s.removeClass("collapsed"),t.removeClass("up")):(s.addClass("collapsed"),t.addClass("up"))}))}function updateURLParameter(e,s,t){var l="",r=e.split("?"),a=r[0],o=r[1],i="";if(o){r=o.split("&");for(var n=0;n<r.length;n++)r[n].split("=")[0]!=s&&(l+=i+r[n],i="&")}return a+"?"+l+(i+""+s+"="+t)}function sanitizeSearchTerm(){if("undefined"!=typeof searchTerm&&-1!==searchTerm.search(/[\s\S]*(<(script|SCRIPT)\b[^>]*>([\s\S]*?)<\/(script|SCRIPT)>|<[\s\S]* (on|ON|oN|On)[\s\S]*=[\s\S]*>)[\s\S]*/gm)){searchTerm="";var e=updateURLParameter(window.location.href,"q",searchTerm);window.history.pushState(null,null,e)}}function continueLoadingResults(){$(window).height()>$("body").innerHeight()-$(".search-solr-results").height()&&loadTenMore(!1)}function getURLParameterByName(e,s){s||(s=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(s);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}function updateFacetsOnURL(e){var s=window.location.search.split("&"),t="",l=!1;if(s.forEach(function(s,r){0===r?t=s:(0===s.indexOf("filterFacets")&&(s=e&&e.length>0?"filterFacets="+encodeURI(e):"",l=!0),s.length>0&&(s="&"+s),t+=s)}),!l){var r="";e&&e.length>0&&(r="&filterFacets="+encodeURI(e)),t+=r}window.history.replaceState(null,null,t)}function updateFacetsFromURL(){initialFacets.forEach(function(e,s){let t=$(".filter-inner input[name='"+e+"']");t.length>0&&(t.prop("checked",!0),filterListSelected.push(e),checkCategoryFilter(t),checkClearAll())}),initialFacets.length>0&&(initialFacets=[]),solrSearchAjaxCall(reloadView,!1,!0)}function solrSearchSubmitAnalytics(e,s,t,l,r,a,o){window.appEventData&&appEventData.push({name:e,digitalData:{page:{search:{searchTerm:a,inputField:s,searchResultsCount:o,typeAhead:t,typeAheadUserString:l,typeAheadPositionSelected:r}}}})}function solrSearchResultsAnalytics(e,s,t){window.appEventData&&appEventData.push({name:e,digitalData:{page:{search:{searchTerm:s,searchResultsCount:t}}}})}function solrSearchResultsClickAnalytics(e,s,t,l,r){window.appEventData&&appEventData.push({name:e,digitalData:{page:{search:{searchResultTitle:s,searchResultLink:t,searchResultPosition:l,searchResultCategory:r}}}})}function solrFacetUpdateAnalytics(e,s){window.appEventData&&appEventData.push({name:e,digitalData:{page:{search:{searchFacets:s}}}})}function solrClickLabelAnalytics(e,s){window.appEventData&&appEventData.push({name:e,digitalData:{page:{search:{clickData:s}}}})}function indexOfData(e,s){var t=-1;return $.each(e,function(e,l){Object.keys(l)[0]===Object.keys(s)[0]&&(t=e)}),t}$(document).ready(function(){if($(document).click(function(e){$target=$(e.target),$target.closest(".left-search-solr-side").length||(buttonFilterClicked?buttonFilterClicked=!1:$(".searchSolrResults .left-search-solr-side").hasClass("open")&&($(".searchSolrResults .left-search-solr-side").removeClass("open"),$("body").css("overflow-y","auto")))}),sanitizeSearchTerm(),$(".search-solr-results").length>0&&($(window).scroll(function(){$(window).scrollTop()+300>$(".search-solr-results").height()&&loadTenMore(!0)}),$(window).resize(function(){continueLoadingResults()})),$(".sort-input-row input").on("click",function(){const e=$(this).attr("data-value");e!==sortBySelectedValue&&(solrClickLabelAnalytics("Search Page Click","Search: Sort by "+(sortBySelectedValue=e)),sortBySolrResults())}),$("#tab-search a").on("mouseenter mouseover click",function(){focusOnSolrSearchInput()}),isMobileResolution()&&(solrCountPaging=7),removeOldSearch(),location.search.length){var e=getURLParameterByName("q",window.location.href);""!=e&&null!=e&&$(".component-dotcom-search-solr .search-input").length>0&&$(".component-dotcom-search-solr .search-input").val(decodeURIComponent(e)),""!=e&&null!=e&&$(".search-input-page-result").length>0&&$(".search-input-page-result").val(decodeURIComponent(e));let s=getURLParameterByName("filterFacets",window.location.href);null!==s&&(initialFacets=s.split(";"))}$(".search-solr-results").length>0&&solrSearchAjaxCall(reloadView,!0,!0),$(".search-panel-solr-page-result img").click(function(){$(".search-panel-solr-page-result .search-input-page-result").val().trim()&&$(".search-panel-solr-page-result .view-all").trigger("mousedown")}),$("a.searchFixed").on("click tap",function(){$(".search-panel-solr").css("visibility","visible"),$(".search-panel-solr").toggle(),$(".search-panel-solr form input").focus()}),$(".component-dotcom-search-solr .search-input, .search-input-page-result").on("keypress",function(e){if(13==e.keyCode){e.preventDefault();var s=$(this).val();if(""!=s){s=encodeURIComponent(s);var t=encodeURI(resultsPageUrl+"?q="+s),l="header menu";$(this).hasClass("search-input-page-result")&&(l="search page text input"),solrSearchSubmitAnalytics("Search Submit",l,!1,null,null,s,null),window.location.assign(t)}}});var s=$.Event("keypress",{keyCode:13});$(".search-solr-sec").each(function(){var e=$(this),t=e.children("img"),l=e.find(".component-dotcom-search-solr .search-input");t.click(function(){e.hasClass("open")&&l.trigger(s)})}),$(".search-solr-input-page-result-container").each(function(){var e=$(this),t=e.find(".inpt-search-icon"),l=e.find(".search-input-page-result");t.click(function(){l.trigger(s)})}),$(".search-panel-solr form input, .search-input-page-result").on("keyup",function(e){const s=$(this).attr("data-min-chars-typed"),t=$(this).attr("data-max-suggestions");var l=$(this).val().toLowerCase().trim(),r=$(this).attr("class");if(l.length>=s){$(this).hasClass("search-input-page-result")||$(".search-clear-solr").show();var a="",o="",i=!1;$.ajax({url:"/bin/servicenow/suggested-search/results",dataType:"json",data:{searchTerm:l},success:function(e){if("false"==e.success)console.log("ERROR: Solr ajax call fail with: "+e.Error);else{if("search-input"===r)if($(".component-dotcom-search-solr .search-input").val().length<s)$(".search-panel-solr .drop-panelx-solr").fadeOut(250),0===$(".component-dotcom-search-solr .search-input").val().length&&($(".component-dotcom-search-solr .search-input").val(""),$(".search-clear-solr").hide());else{for(i=e.suggest[Object.keys(e.suggest)[0]][l].suggestions,index=0;index<i.length&&index<t;++index)a+="<li class='kw'>"+highlightSearchTerm(l,i[index].term)+"</li>";a+='<div class="view-all"><div class="cta-component cta-text-arrow acapulco-cta"><a href="#" target="">'+Granite.I18n.get("viewAllResults")+'<span class="cta-title-link-arrow"><svg width="55px" height="14px" viewBox="0 0 24 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <desc></desc> <defs></defs> <g id="svg-group" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" transform="translate(-10, 0)"> <g id="Secondary-CTA-Dark" transform="translate(-102.000000, -8.000000)" stroke="#81B5A1" stroke-width="2"> <g transform="translate(0.000000, 5.000000)" id="Page-1"> <g transform="translate(103.000000, 4.000000)"><g class="path-1"> <path d="M0,5 L31,5" id="Stroke-1"></path> <polyline id="polyline-3" points="26,10 31,5 26,0"></polyline> </g> </g> </g> </g> </g></svg></span></a><span class="cta-background-full"></span></div></div>',i?($(".search-panel-solr .drop-panelx-solr").fadeIn(300).css("visibility","visible"),$("#sNowGlobalNav-header .direct-keywords-solr").css("display","none")):($(".search-panel-solr .drop-panelx-solr").fadeOut(250),$("#sNowGlobalNav-header .direct-keywords-solr").css("display","block")),$(".search-panel-solr .drop-panelx-solr").css("display","block"),$(".search-panel-solr .drop-panelx-solr").html(a)}if("search-input-page-result"===r)if($(".search-input-page-result").val().length<s)$(".drop-panelx-solr-page-result").fadeOut(250),0===$(".search-input-page-result").val().length&&($(".search-input-page-result").val(""),$(".drop-panelx-solr-page-result").css("display","none"));else{for(i=e.suggest[Object.keys(e.suggest)[0]][l].suggestions,index=0;index<i.length&&index<t;++index)o+="<li class='kw'>"+highlightSearchTerm(l,i[index].term)+"</li>";o+='<div class="view-all"><div class="cta-component cta-text-arrow acapulco-cta"><a href="#" target="">'+Granite.I18n.get("viewAllResults")+'<span class="cta-title-link-arrow"><svg width="55px" height="14px" viewBox="0 0 24 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <desc></desc> <defs></defs> <g id="svg-group" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" transform="translate(-10, 0)"> <g id="Secondary-CTA-Dark" transform="translate(-102.000000, -8.000000)" stroke="#81B5A1" stroke-width="2"> <g transform="translate(0.000000, 5.000000)" id="Page-1"> <g transform="translate(103.000000, 4.000000)"><g class="path-1"> <path d="M0,5 L31,5" id="Stroke-1"></path> <polyline id="polyline-3" points="26,10 31,5 26,0"></polyline> </g> </g> </g> </g> </g></svg></span></a><span class="cta-background-full"></span></div></div>',i?($(".drop-panelx-solr-page-result").fadeIn(300).css("visibility","visible"),$(".direct-keywords-solr-page-result").css("display","none")):($(".drop-panelx-solr-page-result").fadeOut(250),$(".direct-keywords-solr-page-result").css("display","block")),$(".drop-panelx-solr-page-result").css("display","block"),$(".drop-panelx-solr-page-result").html(o)}$(".search-panel-solr .view-all, .search-panel-solr-page-result .view-all").on("mousedown",function(e){e.preventDefault();var s="",t="Header menu";$(this).parents(".component-dotcom-search-solr").length>0?(s=$(".component-dotcom-search-solr .search-input").val(),t="search page text input"):$(this).parents(".search-solr-input-page-result-container").length>0&&(s=$(".search-panel-solr-page-result .search-input-page-result").val()),solrClickLabelAnalytics("Search Page Click","Search:View all results"),solrSearchSubmitAnalytics("Search Submit",t,!1,null,null,s,null);var l=encodeURI(resultsPageUrl+"?q="+s);window.location.assign(l),$(document).scrollTop(0)}),$(".search-click-solr, .search-click-solr-page-result").on("click tap",function(){var e="";if((e=$(this).hasClass("search-click-solr")?$(".component-dotcom-search-solr .search-input").val():$(".search-input-page-result").val()).length>0){var s=encodeURI(resultsPageUrl+"?q="+e);window.location.replace(s),$(document).scrollTop(0)}}),$(".search-panel-solr .drop-panelx-solr li.kw").on("click tap",function(){var e=$(".component-dotcom-search-solr .search-input").val(),s=$(this).index();$(".component-dotcom-search-solr .search-input").val($(this).text()),$(".search-input-page-result").val($(this).text()),solrSearchSubmitAnalytics("Search Submit","search suggestions",!0,e,s,$(this).text(),null);var t=encodeURI(resultsPageUrl+"?q="+$(this).text());window.location.assign(t),$(document).scrollTop(0)}),$(".search-panel-solr-page-result .drop-panelx-solr-page-result li.kw").on("mousedown",function(){var e=$(".search-input-page-result").val(),s=$(this).index();$(".component-dotcom-search-solr .search-input").val($(this).text()),$(".search-input-page-result").val($(this).text()),solrSearchSubmitAnalytics("Search Submit","search suggestions",!0,e,s,$(this).text(),null);var t=encodeURI(resultsPageUrl+"?q="+$(this).text());window.location.assign(t),$(document).scrollTop(0)})}},error:function(e){}})}else"search-input"===r?($(".search-panel-solr .drop-panelx-solr").fadeOut(250).css("visibility","hidden"),$("#sNowGlobalNav-header .direct-keywords-solr").css("display","block")):"search-input-page-result"===r&&($(".drop-panelx-solr-page-result").fadeOut(300).css("visibility","hidden"),$(".direct-keywords-solr-page-result").fadeIn(300).css("visibility","visible"),$(".direct-keywords-solr-page-result").css("display","block"));8==e.which&&0==$(".search-panel-solr .search-input").val().length&&$(".search-panel-solr .drop-panelx-solr").css("display","none")}),$("#drop-search").on("click tap",".search-clear-solr",function(){$(".component-dotcom-search-solr .search-input").val("").trigger("keyup"),$(".search-panel-solr .drop-panelx-solr").fadeOut(250),$(".search-clear-solr").hide()}),$("img.level").on("click tap",function(){var e=$(".component-dotcom-search-solr .search-input").val();if(""!=e){var s=encodeURI(resultsPageUrl+"?q="+e);window.location.replace(s)}}),$("#drop-search").hasClass("off")&&($(".search-input").val("").trigger("keyup"),$(".search-panel-solr .drop-panelx-solr").css("display","none")),$(".search-input-page-result").on("blur",function(){$(".direct-keywords-solr-page-result").css("display","none"),$(".drop-panelx-solr-page-result").css("display","none")}),$(".direct-keywords-solr-page-result .keywords span").on("mousedown",function(e){const s=$(this).find("a"),t=s.attr("data-url");if("_blank"==s.attr("target")){window.open(t,"_blank").focus()}else window.location=t;e.preventDefault()}),$(".component-secondary-nav.transparent-secondary-nav").length&&$(".site-body-content-wrapper .searchSolrResults").addClass("has-secondary-nav"),parseInt($(".search-input-page-result").attr("data-max-suggestions"))>7?$(".searchSolrResults").addClass("more-than-seven-suggestions"):$(".searchSolrResults").addClass("seven-or-less-suggestions")});